<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />

    <title>PokeWith :: Register</title>

    <!-- favicon -->
    <link rel="shortcut icon" href="/img/poke-favi.png" type="image/x-icon" />
    <!-- Custom fonts for this template-->
    <link href="/vendor/fontawesome-free/css/all.css" rel="stylesheet" type="text/css" />
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet" />

    <!-- Custom styles for this template-->
    <link href="/css/sb-admin-2.css" rel="stylesheet" />
    <link rel="stylesheet" href="/css/custom-style.css" />
  </head>

  <body class="bg-gradient-info">
    <div class="container">
      <div class="card o-hidden border-0 shadow-lg my-5">
        <div class="card-body p-0">
          <!-- Nested Row within Card Body -->
          <div class="row">
            <div class="col-lg-5 d-none d-lg-block bg-warning">
              <div class="d-flex justify-content-center mt-5">
                <img src="/img/paduck.png" />
              </div>
            </div>
            <div class="col-lg-7">
              <div class="p-5">
                <div class="text-center">
                  <h1 class="h4 text-gray-900 mb-4">Account Option</h1>
                  <p>Please insert additional information.</p>
                </div>
                <form class="user" method="post">
                  <div class="form-group">
                    <input type="text" class="form-control form-control-user nickname1" id="nickname1" placeholder="Nickname" />
                  </div>
                  <div class="form-group">
                    <input type="text" class="form-control form-control-user friendCode1" id="friendCode1" placeholder="Friendcode" maxlength="12" />
                  </div>
                  <a href="#" id="register-btn" class="btn btn-info btn-user btn-block register-btn"> Register Account </a>
                  <a href="#" id="clear-btn" class="btn btn-warning btn-user btn-block clear-btn"> Clear </a>
                </form>
                <hr />
                <div class="text-center err-msg"></div>
                <!-- <div class="text-center">
                  <a class="small" href="forgot-password.html">Forgot Password?</a>
                </div> -->
                <!-- <div class="text-center">
                  <a class="small" href="login.html">Already have an account? Login!</a>
                </div> -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap core JavaScript-->
    <script src="/vendor/jquery/jquery.min.js"></script>
    <script src="/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Core plugin JavaScript-->
    <script src="/vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Custom scripts for all pages-->
    <script src="/js/sb-admin-2.min.js"></script>

    <script>
      // jQuery AJAX 통신

      // $(document).ready(function () {
      //   $('#register-btn').click(function (e) {
      //     e.preventDefault();

      //     let data = { nickname1: $('#nickname1').val(), friendCode1: $('#friendCode1').val() };
      //     jsonData = JSON.stringify(data);
      //     console.log($('#friendCode1').val().length);

      //     $.ajax({
      //       type: 'post',
      //       url: '/newsignjson',
      //       data: jsonData,
      //       dataType: 'json',
      //       contentType: 'application/json',
      //       success: function (data) {
      //         console.log(data);
      //         alert('success');
      //       },
      //       error: function (jqXHR, textStatus, errorThrown) {
      //         alert(`error! \n ${textStatus} : ${errorThrown}`);
      //       },
      //     });
      //   });

      //   });

      const registerBtn = document.querySelector(".register-btn");
      const clearBtn = document.querySelector(".clear-btn");
      const errMsg = document.querySelector(".err-msg");

      const inputName = document.querySelector(".nickname1");
      const inputCode = document.querySelector(".friendCode1");

      // 더미 데이터
      let userInfoObj = {
        userId: "123456789",
        nickname1: "",
        friendCode1: "",
      };

      function clearInput(event) {
        event.preventDefault();
        inputName.value = "";
        inputCode.value = "";
        errMsg.innerText = "";
      }

      function handleRegister() {
        const sendName = inputName.value;
        const nameRgx = RegExp(/^[가-힣A-Za-z0-9_\-]{5,20}$/);
        const name = nameRgx.test(sendName);
        if (name == false) {
          errMsg.innerText = "Check your Nickname.";
        } else {
          const sendCode = inputCode.value;
          const codeRgx = RegExp(/^[0-9_\-]{12}$/);
          const code = codeRgx.test(sendCode);
          if (code == false) {
            errMsg.innerText = "Check your Friend code.";
          } else {
            console.log("ajax ready :)");
            // registerAPI();
          }
        }
      }
      // AJAX

      function registerAPI() {
        let xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function () {
          if (xhttp.readyState === xhttp.DONE) {
            if (xhttp.status === 200 || xhttp.status === 201) {
              console.log("success!");
            } else {
              console.log("err!");
            }
          }
        };

        xhttp.open("post", "/");
        xhttp.setRequestHeader("Content-Type", "application/json");
        xhttp.send(JSON.stringify(userInfoObj));
      }

      registerBtn.addEventListener("click", handleRegister);
      clearBtn.addEventListener("click", clearInput);
    </script>
  </body>
</html>
